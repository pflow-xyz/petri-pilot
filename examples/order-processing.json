{
  "name": "order-processing",
  "description": "Simple order processing workflow with validation and shipping",
  "graphql": {
    "enabled": true,
    "playground": true
  },
  "debug": {
    "enabled": true,
    "eval": true
  },
  "navigation": {
    "brand": "Order Processing",
    "items": [
      {"label": "Orders", "path": "/orders", "icon": "üìã"},
      {"label": "New Order", "path": "/orders/new", "icon": "‚ûï"},
      {"label": "Admin", "path": "/admin", "icon": "‚öôÔ∏è", "roles": ["admin"]}
    ]
  },
  "eventSourcing": {
    "snapshots": {
      "enabled": true,
      "frequency": 100
    },
    "retention": {
      "events": "90d",
      "snapshots": "1y"
    }
  },
  "admin": {
    "enabled": true,
    "path": "/admin",
    "roles": ["admin"],
    "features": ["list", "detail", "history"]
  },
  "sla": {
    "default": "30m",
    "byPriority": {
      "high": "15m",
      "normal": "30m",
      "low": "2h"
    },
    "warningAt": 0.8,
    "criticalAt": 0.95,
    "onBreach": "alert"
  },
  "events": [
    {
      "id": "order_validated",
      "name": "Order Validated",
      "description": "Order has passed validation checks",
      "fields": [
        {"name": "order_id", "type": "string", "required": true, "description": "Unique order identifier"},
        {"name": "customer_name", "type": "string", "required": true},
        {"name": "customer_email", "type": "string"},
        {"name": "shipping_address", "type": "string"},
        {"name": "total", "type": "number", "required": true},
        {"name": "status", "type": "string"},
        {"name": "created_at", "type": "time"}
      ]
    },
    {
      "id": "order_rejected",
      "name": "Order Rejected",
      "description": "Order failed validation",
      "fields": [
        {"name": "order_id", "type": "string", "required": true},
        {"name": "customer_name", "type": "string"},
        {"name": "rejection_reason", "type": "string", "required": true},
        {"name": "status", "type": "string"}
      ]
    },
    {
      "id": "payment_processed",
      "name": "Payment Processed",
      "description": "Customer payment has been charged",
      "fields": [
        {"name": "order_id", "type": "string", "required": true},
        {"name": "total", "type": "number", "required": true},
        {"name": "payment_method", "type": "string"},
        {"name": "payment_status", "type": "string"},
        {"name": "transaction_id", "type": "string"}
      ]
    },
    {
      "id": "order_shipped",
      "name": "Order Shipped",
      "description": "Order has been sent to shipping carrier",
      "fields": [
        {"name": "order_id", "type": "string", "required": true},
        {"name": "tracking_number", "type": "string"},
        {"name": "carrier", "type": "string"},
        {"name": "shipped_at", "type": "time"}
      ]
    },
    {
      "id": "order_completed",
      "name": "Order Completed",
      "description": "Order fulfillment confirmed",
      "fields": [
        {"name": "order_id", "type": "string", "required": true},
        {"name": "completed_at", "type": "time"}
      ]
    }
  ],
  "places": [
    {"id": "received", "description": "Order received and awaiting processing", "initial": 1},
    {"id": "validated", "description": "Order passed validation", "initial": 0},
    {"id": "rejected", "description": "Order failed validation", "initial": 0},
    {"id": "paid", "description": "Payment completed", "initial": 0},
    {"id": "shipped", "description": "Order shipped to customer", "initial": 0},
    {"id": "completed", "description": "Order fulfilled", "initial": 0}
  ],
  "transitions": [
    {
      "id": "validate",
      "description": "Check order validity",
      "event": "order_validated",
      "duration": "2m",
      "maxDuration": "5m",
      "bindings": [
        {"name": "order_id", "type": "string"},
        {"name": "customer_name", "type": "string"},
        {"name": "customer_email", "type": "string"},
        {"name": "shipping_address", "type": "string"},
        {"name": "total", "type": "number", "value": true}
      ]
    },
    {
      "id": "reject",
      "description": "Mark order as invalid",
      "event": "order_rejected",
      "bindings": [
        {"name": "order_id", "type": "string"},
        {"name": "rejection_reason", "type": "string"}
      ]
    },
    {
      "id": "process_payment",
      "description": "Charge customer payment",
      "event": "payment_processed",
      "bindings": [
        {"name": "order_id", "type": "string"},
        {"name": "total", "type": "number", "value": true},
        {"name": "payment_method", "type": "string"}
      ]
    },
    {
      "id": "ship",
      "description": "Send order to shipping",
      "event": "order_shipped",
      "duration": "10m",
      "maxDuration": "30m",
      "bindings": [
        {"name": "order_id", "type": "string"},
        {"name": "tracking_number", "type": "string"},
        {"name": "carrier", "type": "string"}
      ]
    },
    {
      "id": "confirm",
      "description": "Mark order as complete",
      "event": "order_completed",
      "bindings": [
        {"name": "order_id", "type": "string"}
      ]
    }
  ],
  "arcs": [
    {"from": "received", "to": "validate"},
    {"from": "validate", "to": "validated"},
    {"from": "received", "to": "reject"},
    {"from": "reject", "to": "rejected"},
    {"from": "validated", "to": "process_payment"},
    {"from": "process_payment", "to": "paid"},
    {"from": "paid", "to": "ship"},
    {"from": "ship", "to": "shipped"},
    {"from": "shipped", "to": "confirm"},
    {"from": "confirm", "to": "completed"}
  ],
  "constraints": [
    {"id": "conservation", "expr": "received + validated + rejected + paid + shipped + completed == 1"}
  ],
  "roles": [
    {
      "id": "customer",
      "name": "Customer",
      "description": "End user placing orders"
    },
    {
      "id": "fulfillment",
      "name": "Fulfillment",
      "description": "Warehouse staff who validate and ship orders"
    },
    {
      "id": "system",
      "name": "System",
      "description": "Automated payment processing"
    },
    {
      "id": "admin",
      "name": "Administrator",
      "description": "Full access to all operations",
      "inherits": ["fulfillment"]
    }
  ],
  "access": [
    {
      "transition": "validate",
      "roles": ["fulfillment"]
    },
    {
      "transition": "reject",
      "roles": ["fulfillment"]
    },
    {
      "transition": "process_payment",
      "roles": ["system"]
    },
    {
      "transition": "ship",
      "roles": ["fulfillment"]
    },
    {
      "transition": "confirm",
      "roles": ["fulfillment"]
    }
  ],
  "views": [
    {
      "id": "order-table",
      "name": "Orders List",
      "kind": "table",
      "description": "List view of all orders",
      "groups": [
        {
          "id": "columns",
          "fields": [
            {"binding": "order_id", "label": "Order ID", "type": "text", "readonly": true},
            {"binding": "customer_name", "label": "Customer", "type": "text", "readonly": true},
            {"binding": "total", "label": "Total", "type": "number", "readonly": true},
            {"binding": "status", "label": "Status", "type": "text", "readonly": true},
            {"binding": "created_at", "label": "Created", "type": "date", "readonly": true}
          ]
        }
      ],
      "actions": ["validate", "reject", "ship", "confirm"]
    },
    {
      "id": "order-detail",
      "name": "Order Detail",
      "kind": "detail",
      "description": "Full order details",
      "groups": [
        {
          "id": "order",
          "name": "Order Information",
          "fields": [
            {"binding": "order_id", "label": "Order ID", "type": "text", "readonly": true},
            {"binding": "status", "label": "Status", "type": "text", "readonly": true},
            {"binding": "created_at", "label": "Created", "type": "date", "readonly": true}
          ]
        },
        {
          "id": "customer",
          "name": "Customer Information",
          "fields": [
            {"binding": "customer_name", "label": "Name", "type": "text", "readonly": true},
            {"binding": "customer_email", "label": "Email", "type": "email", "readonly": true},
            {"binding": "shipping_address", "label": "Shipping Address", "type": "text", "readonly": true}
          ]
        },
        {
          "id": "payment",
          "name": "Payment",
          "fields": [
            {"binding": "total", "label": "Total", "type": "number", "readonly": true},
            {"binding": "payment_method", "label": "Payment Method", "type": "text", "readonly": true},
            {"binding": "payment_status", "label": "Payment Status", "type": "text", "readonly": true}
          ]
        }
      ],
      "actions": ["validate", "reject", "process_payment", "ship", "confirm"]
    }
  ]
}
