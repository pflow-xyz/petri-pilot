{
  "name": "texas-holdem",
  "description": "Texas Hold'em Poker (5-player table)",
  "places": [
    {"id": "waiting", "initial": 1, "description": "Waiting for hand to start"},
    {"id": "preflop", "description": "Pre-flop betting round"},
    {"id": "flop", "description": "Flop betting round"},
    {"id": "turn_round", "description": "Turn betting round"},
    {"id": "river", "description": "River betting round"},
    {"id": "showdown", "description": "Showdown - compare hands"},
    {"id": "complete", "description": "Hand complete"},

    {"id": "dealer_action", "description": "Dealer can deal cards"},

    {"id": "p0_turn", "description": "Player 0's turn to act"},
    {"id": "p1_turn", "description": "Player 1's turn to act"},
    {"id": "p2_turn", "description": "Player 2's turn to act"},
    {"id": "p3_turn", "description": "Player 3's turn to act"},
    {"id": "p4_turn", "description": "Player 4's turn to act"},

    {"id": "p0_active", "initial": 1, "description": "Player 0 is in the hand"},
    {"id": "p1_active", "initial": 1, "description": "Player 1 is in the hand"},
    {"id": "p2_active", "initial": 1, "description": "Player 2 is in the hand"},
    {"id": "p3_active", "initial": 1, "description": "Player 3 is in the hand"},
    {"id": "p4_active", "initial": 1, "description": "Player 4 is in the hand"},

    {"id": "p0_folded", "description": "Player 0 has folded"},
    {"id": "p1_folded", "description": "Player 1 has folded"},
    {"id": "p2_folded", "description": "Player 2 has folded"},
    {"id": "p3_folded", "description": "Player 3 has folded"},
    {"id": "p4_folded", "description": "Player 4 has folded"},

    {"id": "p0_acted", "description": "Player 0 has acted this round"},
    {"id": "p1_acted", "description": "Player 1 has acted this round"},
    {"id": "p2_acted", "description": "Player 2 has acted this round"},
    {"id": "p3_acted", "description": "Player 3 has acted this round"},
    {"id": "p4_acted", "description": "Player 4 has acted this round"},

    {"id": "round_open", "description": "Betting round is open"}
  ],
  "transitions": [
    {"id": "start_hand", "description": "Start a new hand", "event": "hand_started"},
    {"id": "deal_preflop", "description": "Deal hole cards to all players", "event": "preflop_dealt"},
    {"id": "deal_flop", "description": "Deal the flop (3 community cards)", "event": "flop_dealt"},
    {"id": "deal_turn", "description": "Deal the turn (1 community card)", "event": "turn_dealt"},
    {"id": "deal_river", "description": "Deal the river (1 community card)", "event": "river_dealt"},
    {"id": "go_showdown", "description": "Proceed to showdown", "event": "showdown_reached"},
    {"id": "determine_winner", "description": "Determine the winner", "event": "winner_determined"},
    {"id": "end_hand", "description": "End the hand", "event": "hand_ended"},

    {"id": "advance_to_p1", "description": "Pass turn to player 1"},
    {"id": "advance_to_p2", "description": "Pass turn to player 2"},
    {"id": "advance_to_p3", "description": "Pass turn to player 3"},
    {"id": "advance_to_p4", "description": "Pass turn to player 4"},
    {"id": "advance_to_p0", "description": "Pass turn to player 0"},
    {"id": "end_betting_round", "description": "End the betting round"},

    {"id": "p0_fold", "description": "Player 0 folds", "event": "player_folded"},
    {"id": "p0_check", "description": "Player 0 checks", "event": "player_checked"},
    {"id": "p0_call", "description": "Player 0 calls", "event": "player_called"},
    {"id": "p0_raise", "description": "Player 0 raises", "event": "player_raised"},

    {"id": "p1_fold", "description": "Player 1 folds", "event": "player_folded"},
    {"id": "p1_check", "description": "Player 1 checks", "event": "player_checked"},
    {"id": "p1_call", "description": "Player 1 calls", "event": "player_called"},
    {"id": "p1_raise", "description": "Player 1 raises", "event": "player_raised"},

    {"id": "p2_fold", "description": "Player 2 folds", "event": "player_folded"},
    {"id": "p2_check", "description": "Player 2 checks", "event": "player_checked"},
    {"id": "p2_call", "description": "Player 2 calls", "event": "player_called"},
    {"id": "p2_raise", "description": "Player 2 raises", "event": "player_raised"},

    {"id": "p3_fold", "description": "Player 3 folds", "event": "player_folded"},
    {"id": "p3_check", "description": "Player 3 checks", "event": "player_checked"},
    {"id": "p3_call", "description": "Player 3 calls", "event": "player_called"},
    {"id": "p3_raise", "description": "Player 3 raises", "event": "player_raised"},

    {"id": "p4_fold", "description": "Player 4 folds", "event": "player_folded"},
    {"id": "p4_check", "description": "Player 4 checks", "event": "player_checked"},
    {"id": "p4_call", "description": "Player 4 calls", "event": "player_called"},
    {"id": "p4_raise", "description": "Player 4 raises", "event": "player_raised"}
  ],
  "arcs": [
    {"from": "waiting", "to": "start_hand"},
    {"from": "start_hand", "to": "dealer_action"},

    {"from": "dealer_action", "to": "deal_preflop"},
    {"from": "deal_preflop", "to": "preflop"},
    {"from": "deal_preflop", "to": "p0_turn"},
    {"from": "deal_preflop", "to": "round_open"},

    {"from": "p0_turn", "to": "p0_fold"},
    {"from": "p0_active", "to": "p0_fold"},
    {"from": "p0_fold", "to": "p0_folded"},
    {"from": "p0_fold", "to": "p0_acted"},

    {"from": "p0_turn", "to": "p0_check"},
    {"from": "p0_active", "to": "p0_check"},
    {"from": "p0_check", "to": "p0_active"},
    {"from": "p0_check", "to": "p0_acted"},

    {"from": "p0_turn", "to": "p0_call"},
    {"from": "p0_active", "to": "p0_call"},
    {"from": "p0_call", "to": "p0_active"},
    {"from": "p0_call", "to": "p0_acted"},

    {"from": "p0_turn", "to": "p0_raise"},
    {"from": "p0_active", "to": "p0_raise"},
    {"from": "p0_raise", "to": "p0_active"},
    {"from": "p0_raise", "to": "p0_acted"},

    {"from": "p1_turn", "to": "p1_fold"},
    {"from": "p1_active", "to": "p1_fold"},
    {"from": "p1_fold", "to": "p1_folded"},
    {"from": "p1_fold", "to": "p1_acted"},

    {"from": "p1_turn", "to": "p1_check"},
    {"from": "p1_active", "to": "p1_check"},
    {"from": "p1_check", "to": "p1_active"},
    {"from": "p1_check", "to": "p1_acted"},

    {"from": "p1_turn", "to": "p1_call"},
    {"from": "p1_active", "to": "p1_call"},
    {"from": "p1_call", "to": "p1_active"},
    {"from": "p1_call", "to": "p1_acted"},

    {"from": "p1_turn", "to": "p1_raise"},
    {"from": "p1_active", "to": "p1_raise"},
    {"from": "p1_raise", "to": "p1_active"},
    {"from": "p1_raise", "to": "p1_acted"},

    {"from": "p2_turn", "to": "p2_fold"},
    {"from": "p2_active", "to": "p2_fold"},
    {"from": "p2_fold", "to": "p2_folded"},
    {"from": "p2_fold", "to": "p2_acted"},

    {"from": "p2_turn", "to": "p2_check"},
    {"from": "p2_active", "to": "p2_check"},
    {"from": "p2_check", "to": "p2_active"},
    {"from": "p2_check", "to": "p2_acted"},

    {"from": "p2_turn", "to": "p2_call"},
    {"from": "p2_active", "to": "p2_call"},
    {"from": "p2_call", "to": "p2_active"},
    {"from": "p2_call", "to": "p2_acted"},

    {"from": "p2_turn", "to": "p2_raise"},
    {"from": "p2_active", "to": "p2_raise"},
    {"from": "p2_raise", "to": "p2_active"},
    {"from": "p2_raise", "to": "p2_acted"},

    {"from": "p3_turn", "to": "p3_fold"},
    {"from": "p3_active", "to": "p3_fold"},
    {"from": "p3_fold", "to": "p3_folded"},
    {"from": "p3_fold", "to": "p3_acted"},

    {"from": "p3_turn", "to": "p3_check"},
    {"from": "p3_active", "to": "p3_check"},
    {"from": "p3_check", "to": "p3_active"},
    {"from": "p3_check", "to": "p3_acted"},

    {"from": "p3_turn", "to": "p3_call"},
    {"from": "p3_active", "to": "p3_call"},
    {"from": "p3_call", "to": "p3_active"},
    {"from": "p3_call", "to": "p3_acted"},

    {"from": "p3_turn", "to": "p3_raise"},
    {"from": "p3_active", "to": "p3_raise"},
    {"from": "p3_raise", "to": "p3_active"},
    {"from": "p3_raise", "to": "p3_acted"},

    {"from": "p4_turn", "to": "p4_fold"},
    {"from": "p4_active", "to": "p4_fold"},
    {"from": "p4_fold", "to": "p4_folded"},
    {"from": "p4_fold", "to": "p4_acted"},

    {"from": "p4_turn", "to": "p4_check"},
    {"from": "p4_active", "to": "p4_check"},
    {"from": "p4_check", "to": "p4_active"},
    {"from": "p4_check", "to": "p4_acted"},

    {"from": "p4_turn", "to": "p4_call"},
    {"from": "p4_active", "to": "p4_call"},
    {"from": "p4_call", "to": "p4_active"},
    {"from": "p4_call", "to": "p4_acted"},

    {"from": "p4_turn", "to": "p4_raise"},
    {"from": "p4_active", "to": "p4_raise"},
    {"from": "p4_raise", "to": "p4_active"},
    {"from": "p4_raise", "to": "p4_acted"},

    {"from": "p0_acted", "to": "advance_to_p1"},
    {"from": "p1_active", "to": "advance_to_p1"},
    {"from": "advance_to_p1", "to": "p1_turn"},
    {"from": "advance_to_p1", "to": "p1_active"},

    {"from": "p1_acted", "to": "advance_to_p2"},
    {"from": "p2_active", "to": "advance_to_p2"},
    {"from": "advance_to_p2", "to": "p2_turn"},
    {"from": "advance_to_p2", "to": "p2_active"},

    {"from": "p2_acted", "to": "advance_to_p3"},
    {"from": "p3_active", "to": "advance_to_p3"},
    {"from": "advance_to_p3", "to": "p3_turn"},
    {"from": "advance_to_p3", "to": "p3_active"},

    {"from": "p3_acted", "to": "advance_to_p4"},
    {"from": "p4_active", "to": "advance_to_p4"},
    {"from": "advance_to_p4", "to": "p4_turn"},
    {"from": "advance_to_p4", "to": "p4_active"},

    {"from": "p4_acted", "to": "advance_to_p0"},
    {"from": "p0_active", "to": "advance_to_p0"},
    {"from": "advance_to_p0", "to": "p0_turn"},
    {"from": "advance_to_p0", "to": "p0_active"},

    {"from": "round_open", "to": "end_betting_round"},
    {"from": "p0_acted", "to": "end_betting_round"},
    {"from": "p1_acted", "to": "end_betting_round"},
    {"from": "p2_acted", "to": "end_betting_round"},
    {"from": "p3_acted", "to": "end_betting_round"},
    {"from": "p4_acted", "to": "end_betting_round"},
    {"from": "end_betting_round", "to": "dealer_action"},

    {"from": "preflop", "to": "deal_flop"},
    {"from": "dealer_action", "to": "deal_flop"},
    {"from": "deal_flop", "to": "flop"},
    {"from": "deal_flop", "to": "p0_turn"},
    {"from": "deal_flop", "to": "round_open"},

    {"from": "flop", "to": "deal_turn"},
    {"from": "dealer_action", "to": "deal_turn"},
    {"from": "deal_turn", "to": "turn_round"},
    {"from": "deal_turn", "to": "p0_turn"},
    {"from": "deal_turn", "to": "round_open"},

    {"from": "turn_round", "to": "deal_river"},
    {"from": "dealer_action", "to": "deal_river"},
    {"from": "deal_river", "to": "river"},
    {"from": "deal_river", "to": "p0_turn"},
    {"from": "deal_river", "to": "round_open"},

    {"from": "river", "to": "go_showdown"},
    {"from": "dealer_action", "to": "go_showdown"},
    {"from": "go_showdown", "to": "showdown"},

    {"from": "showdown", "to": "determine_winner"},
    {"from": "determine_winner", "to": "complete"},

    {"from": "complete", "to": "end_hand"},
    {"from": "end_hand", "to": "waiting"}
  ],
  "events": [
    {
      "id": "hand_started",
      "description": "A new hand has started",
      "fields": [
        {"name": "hand_number", "type": "int64"},
        {"name": "dealer_position", "type": "int64"},
        {"name": "small_blind", "type": "int64"},
        {"name": "big_blind", "type": "int64"}
      ]
    },
    {
      "id": "preflop_dealt",
      "description": "Hole cards dealt to players",
      "fields": [
        {"name": "hands", "type": "string", "description": "JSON encoded hole cards per player"}
      ]
    },
    {
      "id": "flop_dealt",
      "description": "Flop cards dealt",
      "fields": [
        {"name": "cards", "type": "string", "description": "JSON array of 3 cards"}
      ]
    },
    {
      "id": "turn_dealt",
      "description": "Turn card dealt",
      "fields": [
        {"name": "card", "type": "string"}
      ]
    },
    {
      "id": "river_dealt",
      "description": "River card dealt",
      "fields": [
        {"name": "card", "type": "string"}
      ]
    },
    {
      "id": "player_folded",
      "description": "A player folded",
      "fields": [
        {"name": "player", "type": "int64"},
        {"name": "seat", "type": "string"}
      ]
    },
    {
      "id": "player_checked",
      "description": "A player checked",
      "fields": [
        {"name": "player", "type": "int64"},
        {"name": "seat", "type": "string"}
      ]
    },
    {
      "id": "player_called",
      "description": "A player called",
      "fields": [
        {"name": "player", "type": "int64"},
        {"name": "seat", "type": "string"},
        {"name": "amount", "type": "int64"}
      ]
    },
    {
      "id": "player_raised",
      "description": "A player raised",
      "fields": [
        {"name": "player", "type": "int64"},
        {"name": "seat", "type": "string"},
        {"name": "amount", "type": "int64"},
        {"name": "total_bet", "type": "int64"}
      ]
    },
    {
      "id": "showdown_reached",
      "description": "All betting complete, proceeding to showdown",
      "fields": []
    },
    {
      "id": "winner_determined",
      "description": "Winner has been determined",
      "fields": [
        {"name": "winner", "type": "int64"},
        {"name": "winning_hand", "type": "string"},
        {"name": "pot_amount", "type": "int64"}
      ]
    },
    {
      "id": "hand_ended",
      "description": "Hand is complete",
      "fields": [
        {"name": "hand_number", "type": "int64"}
      ]
    }
  ],
  "roles": [
    {"id": "player_0", "name": "Seat 1"},
    {"id": "player_1", "name": "Seat 2"},
    {"id": "player_2", "name": "Seat 3"},
    {"id": "player_3", "name": "Seat 4"},
    {"id": "player_4", "name": "Seat 5"},
    {"id": "dealer", "name": "Dealer"},
    {"id": "admin", "name": "Admin", "inherits": ["dealer"]}
  ],
  "access": [
    {"transition": "start_hand", "roles": ["dealer", "admin"]},
    {"transition": "deal_preflop", "roles": ["dealer"]},
    {"transition": "deal_flop", "roles": ["dealer"]},
    {"transition": "deal_turn", "roles": ["dealer"]},
    {"transition": "deal_river", "roles": ["dealer"]},
    {"transition": "go_showdown", "roles": ["dealer"]},
    {"transition": "determine_winner", "roles": ["dealer"]},
    {"transition": "end_hand", "roles": ["dealer"]},

    {"transition": "p0_fold", "roles": ["player_0"]},
    {"transition": "p0_check", "roles": ["player_0"]},
    {"transition": "p0_call", "roles": ["player_0"]},
    {"transition": "p0_raise", "roles": ["player_0"]},

    {"transition": "p1_fold", "roles": ["player_1"]},
    {"transition": "p1_check", "roles": ["player_1"]},
    {"transition": "p1_call", "roles": ["player_1"]},
    {"transition": "p1_raise", "roles": ["player_1"]},

    {"transition": "p2_fold", "roles": ["player_2"]},
    {"transition": "p2_check", "roles": ["player_2"]},
    {"transition": "p2_call", "roles": ["player_2"]},
    {"transition": "p2_raise", "roles": ["player_2"]},

    {"transition": "p3_fold", "roles": ["player_3"]},
    {"transition": "p3_check", "roles": ["player_3"]},
    {"transition": "p3_call", "roles": ["player_3"]},
    {"transition": "p3_raise", "roles": ["player_3"]},

    {"transition": "p4_fold", "roles": ["player_4"]},
    {"transition": "p4_check", "roles": ["player_4"]},
    {"transition": "p4_call", "roles": ["player_4"]},
    {"transition": "p4_raise", "roles": ["player_4"]}
  ]
}
