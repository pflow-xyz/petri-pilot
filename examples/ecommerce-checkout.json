{
  "name": "ecommerce-checkout",
  "description": "An e-commerce checkout workflow: cart → payment processing → paid. Payment can fail and retry up to 3 times before cancellation.",
  "debug": {
    "enabled": true,
    "eval": true
  },
  "places": [
    {"id": "cart", "description": "Items in shopping cart", "initial": 1},
    {"id": "checkout_started", "description": "Checkout process initiated", "initial": 0},
    {"id": "payment_pending", "description": "Awaiting payment processing", "initial": 0},
    {"id": "payment_processing", "description": "Payment is being processed", "initial": 0},
    {"id": "retry_1", "description": "First payment retry available", "initial": 0},
    {"id": "retry_2", "description": "Second payment retry available", "initial": 0},
    {"id": "retry_3", "description": "Final payment retry available", "initial": 0},
    {"id": "paid", "description": "Payment successful", "initial": 0},
    {"id": "cancelled", "description": "Order cancelled due to payment failure", "initial": 0},
    {"id": "fulfilled", "description": "Order has been fulfilled", "initial": 0}
  ],
  "transitions": [
    {"id": "start_checkout", "description": "Begin checkout process"},
    {"id": "enter_payment", "description": "Enter payment details"},
    {"id": "process_payment", "description": "Process the payment"},
    {"id": "payment_success", "description": "Payment processed successfully"},
    {"id": "payment_fail_1", "description": "First payment attempt failed"},
    {"id": "retry_payment_1", "description": "Retry payment (attempt 2)"},
    {"id": "payment_fail_2", "description": "Second payment attempt failed"},
    {"id": "retry_payment_2", "description": "Retry payment (attempt 3)"},
    {"id": "payment_fail_3", "description": "Third payment attempt failed"},
    {"id": "cancel_order", "description": "Cancel order after max retries"},
    {"id": "fulfill", "description": "Fulfill the order"}
  ],
  "arcs": [
    {"from": "cart", "to": "start_checkout"},
    {"from": "start_checkout", "to": "checkout_started"},
    {"from": "checkout_started", "to": "enter_payment"},
    {"from": "enter_payment", "to": "payment_pending"},
    {"from": "payment_pending", "to": "process_payment"},
    {"from": "process_payment", "to": "payment_processing"},
    {"from": "payment_processing", "to": "payment_success"},
    {"from": "payment_success", "to": "paid"},
    {"from": "payment_processing", "to": "payment_fail_1"},
    {"from": "payment_fail_1", "to": "retry_1"},
    {"from": "retry_1", "to": "retry_payment_1"},
    {"from": "retry_payment_1", "to": "payment_processing"},
    {"from": "payment_processing", "to": "payment_fail_2"},
    {"from": "payment_fail_2", "to": "retry_2"},
    {"from": "retry_2", "to": "retry_payment_2"},
    {"from": "retry_payment_2", "to": "payment_processing"},
    {"from": "payment_processing", "to": "payment_fail_3"},
    {"from": "payment_fail_3", "to": "retry_3"},
    {"from": "retry_3", "to": "cancel_order"},
    {"from": "cancel_order", "to": "cancelled"},
    {"from": "paid", "to": "fulfill"},
    {"from": "fulfill", "to": "fulfilled"}
  ],
  "roles": [
    {
      "id": "customer",
      "name": "Customer",
      "description": "End user making a purchase"
    },
    {
      "id": "system",
      "name": "System",
      "description": "Automated payment processing system"
    },
    {
      "id": "fulfillment",
      "name": "Fulfillment",
      "description": "Warehouse staff who fulfill orders"
    },
    {
      "id": "admin",
      "name": "Administrator",
      "description": "Full access to all operations",
      "inherits": ["customer", "system", "fulfillment"]
    }
  ],
  "access": [
    {
      "transition": "start_checkout",
      "roles": ["customer"]
    },
    {
      "transition": "enter_payment",
      "roles": ["customer"]
    },
    {
      "transition": "process_payment",
      "roles": ["system"]
    },
    {
      "transition": "payment_success",
      "roles": ["system"]
    },
    {
      "transition": "payment_fail_1",
      "roles": ["system"]
    },
    {
      "transition": "retry_payment_1",
      "roles": ["customer"]
    },
    {
      "transition": "payment_fail_2",
      "roles": ["system"]
    },
    {
      "transition": "retry_payment_2",
      "roles": ["customer"]
    },
    {
      "transition": "payment_fail_3",
      "roles": ["system"]
    },
    {
      "transition": "cancel_order",
      "roles": ["system"]
    },
    {
      "transition": "fulfill",
      "roles": ["fulfillment"]
    }
  ],
  "views": [
    {
      "id": "order-table",
      "name": "Orders List",
      "kind": "table",
      "description": "List view of all orders",
      "groups": [
        {
          "id": "columns",
          "fields": [
            {"binding": "order_id", "label": "Order ID", "type": "text", "readonly": true},
            {"binding": "customer_email", "label": "Customer", "type": "email", "readonly": true},
            {"binding": "total", "label": "Total", "type": "number", "readonly": true},
            {"binding": "status", "label": "Status", "type": "text", "readonly": true}
          ]
        }
      ],
      "actions": ["start_checkout", "fulfill"]
    },
    {
      "id": "checkout-form",
      "name": "Checkout",
      "kind": "form",
      "description": "Checkout and payment form",
      "groups": [
        {
          "id": "payment",
          "name": "Payment Details",
          "fields": [
            {"binding": "card_number", "label": "Card Number", "type": "text", "required": true, "placeholder": "1234 5678 9012 3456"},
            {"binding": "expiry", "label": "Expiry Date", "type": "text", "required": true, "placeholder": "MM/YY"},
            {"binding": "cvv", "label": "CVV", "type": "text", "required": true, "placeholder": "123"}
          ]
        },
        {
          "id": "billing",
          "name": "Billing Address",
          "fields": [
            {"binding": "billing_name", "label": "Name", "type": "text", "required": true},
            {"binding": "billing_address", "label": "Address", "type": "text", "required": true},
            {"binding": "billing_city", "label": "City", "type": "text", "required": true},
            {"binding": "billing_zip", "label": "ZIP Code", "type": "text", "required": true}
          ]
        }
      ],
      "actions": ["enter_payment", "process_payment"]
    },
    {
      "id": "order-detail",
      "name": "Order Detail",
      "kind": "detail",
      "description": "Full order details",
      "groups": [
        {
          "id": "order",
          "name": "Order Information",
          "fields": [
            {"binding": "order_id", "label": "Order ID", "type": "text", "readonly": true},
            {"binding": "status", "label": "Status", "type": "text", "readonly": true},
            {"binding": "total", "label": "Total", "type": "number", "readonly": true},
            {"binding": "created_at", "label": "Created", "type": "date", "readonly": true}
          ]
        }
      ],
      "actions": ["retry_payment_1", "retry_payment_2", "cancel_order", "fulfill"]
    }
  ]
}
