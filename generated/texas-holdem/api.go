// Code generated by petri-pilot. DO NOT EDIT.

package main

import (
	"encoding/base64"
	"encoding/json"
	"io/fs"
	"net/http"
	"os"
	"path/filepath"
	"strconv"
	"strings"

	"github.com/pflow-xyz/petri-pilot/pkg/runtime/api"
)

// BuildRouter creates an HTTP router for the texas-holdem workflow.
func BuildRouter(app *Application, middleware *Middleware, sessions SessionStore) http.Handler {
	r := api.NewRouter()

	// Apply auth middleware to extract user from token (optional, doesn't require auth)
	r.Use(OptionalAuthMiddleware(sessions))

	// Health check - always returns ok if server is running
	r.GET("/health", "Health check", func(w http.ResponseWriter, r *http.Request) {
		api.JSON(w, http.StatusOK, map[string]string{"status": "ok"})
	})

	// Readiness check - verifies dependencies (database, etc.)
	r.GET("/ready", "Readiness check", HandleReady(app))

	// Create new aggregate
	r.POST("/api/texasholdem", "Create new texas-holdem", HandleCreate(app))

	// Get aggregate state
	r.GET("/api/texasholdem/{id}", "Get texas-holdem state", HandleGetState(app))


	// Schema viewer endpoint
	r.GET("/api/schema", "Get model schema", HandleGetSchema())



	// Event replay endpoints
	r.GET("/api/texasholdem/{id}/events", "Get event history", HandleGetEvents(app))
	r.GET("/api/texasholdem/{id}/at/{version}", "Get state at version", HandleGetStateAtVersion(app))
	r.POST("/api/texasholdem/{id}/truncate", "Truncate event history to version", HandleTruncate(app))






















	// Transition endpoints
	r.Transition("start_hand", "/api/start_hand", "Start a new hand", HandleStartHand(app))
	r.Transition("deal_preflop", "/api/deal_preflop", "Deal hole cards to all players", HandleDealPreflop(app))
	r.Transition("deal_flop", "/api/deal_flop", "Deal the flop (3 community cards)", HandleDealFlop(app))
	r.Transition("deal_turn", "/api/deal_turn", "Deal the turn (1 community card)", HandleDealTurn(app))
	r.Transition("deal_river", "/api/deal_river", "Deal the river (1 community card)", HandleDealRiver(app))
	r.Transition("go_showdown", "/api/go_showdown", "Proceed to showdown", HandleGoShowdown(app))
	r.Transition("determine_winner", "/api/determine_winner", "Determine the winner", HandleDetermineWinner(app))
	r.Transition("end_hand", "/api/end_hand", "End the hand", HandleEndHand(app))
	r.Transition("advance_to_p1", "/api/advance_to_p1", "Pass turn to player 1", HandleAdvanceToP1(app))
	r.Transition("advance_to_p2", "/api/advance_to_p2", "Pass turn to player 2", HandleAdvanceToP2(app))
	r.Transition("advance_to_p3", "/api/advance_to_p3", "Pass turn to player 3", HandleAdvanceToP3(app))
	r.Transition("advance_to_p4", "/api/advance_to_p4", "Pass turn to player 4", HandleAdvanceToP4(app))
	r.Transition("advance_to_p0", "/api/advance_to_p0", "Pass turn to player 0", HandleAdvanceToP0(app))
	r.Transition("end_betting_round", "/api/end_betting_round", "End the betting round", HandleEndBettingRound(app))
	r.Transition("p0_fold", "/api/p0_fold", "Player 0 folds", HandleP0Fold(app))
	r.Transition("p0_check", "/api/p0_check", "Player 0 checks", HandleP0Check(app))
	r.Transition("p0_call", "/api/p0_call", "Player 0 calls", HandleP0Call(app))
	r.Transition("p0_raise", "/api/p0_raise", "Player 0 raises", HandleP0Raise(app))
	r.Transition("p1_fold", "/api/p1_fold", "Player 1 folds", HandleP1Fold(app))
	r.Transition("p1_check", "/api/p1_check", "Player 1 checks", HandleP1Check(app))
	r.Transition("p1_call", "/api/p1_call", "Player 1 calls", HandleP1Call(app))
	r.Transition("p1_raise", "/api/p1_raise", "Player 1 raises", HandleP1Raise(app))
	r.Transition("p2_fold", "/api/p2_fold", "Player 2 folds", HandleP2Fold(app))
	r.Transition("p2_check", "/api/p2_check", "Player 2 checks", HandleP2Check(app))
	r.Transition("p2_call", "/api/p2_call", "Player 2 calls", HandleP2Call(app))
	r.Transition("p2_raise", "/api/p2_raise", "Player 2 raises", HandleP2Raise(app))
	r.Transition("p3_fold", "/api/p3_fold", "Player 3 folds", HandleP3Fold(app))
	r.Transition("p3_check", "/api/p3_check", "Player 3 checks", HandleP3Check(app))
	r.Transition("p3_call", "/api/p3_call", "Player 3 calls", HandleP3Call(app))
	r.Transition("p3_raise", "/api/p3_raise", "Player 3 raises", HandleP3Raise(app))
	r.Transition("p4_fold", "/api/p4_fold", "Player 4 folds", HandleP4Fold(app))
	r.Transition("p4_check", "/api/p4_check", "Player 4 checks", HandleP4Check(app))
	r.Transition("p4_call", "/api/p4_call", "Player 4 calls", HandleP4Call(app))
	r.Transition("p4_raise", "/api/p4_raise", "Player 4 raises", HandleP4Raise(app))

	// Serve frontend static files
	r.StaticFiles("/", StaticFileHandler())

	return r.Build()
}

// StaticFileHandler returns an http.Handler that serves static files from frontend/.
// It supports SPA routing by returning index.html for paths that don't match static files.
func StaticFileHandler() http.HandlerFunc {
	// Find frontend directory - try custom frontends first, then generated
	frontendPath := ""
	candidates := []string{
		"frontends/texas-holdem",                    // Custom frontend (top priority)
		"frontend",                                    // Running from service directory
		"generated/main/frontend",         // Generated frontend from repo root
		filepath.Join("generated", "main", "frontend"), // Platform-safe
	}

	// Also try relative to executable
	if exe, err := os.Executable(); err == nil {
		exeDir := filepath.Dir(exe)
		candidates = append(candidates,
			filepath.Join(exeDir, "frontends", "texas-holdem"),
			filepath.Join(exeDir, "frontend"),
			filepath.Join(exeDir, "generated", "main", "frontend"),
		)
	}

	for _, candidate := range candidates {
		if _, err := os.Stat(candidate); err == nil {
			frontendPath = candidate
			break
		}
	}

	return func(w http.ResponseWriter, r *http.Request) {
		// No frontend found
		if frontendPath == "" {
			http.Error(w, "Frontend not found", http.StatusNotFound)
			return
		}

		// Clean the path
		path := strings.TrimPrefix(r.URL.Path, "/")
		if path == "" {
			path = "index.html"
		}

		// Try to serve the file
		fullPath := filepath.Join(frontendPath, path)

		// Check if file exists
		info, err := os.Stat(fullPath)
		if err != nil || info.IsDir() {
			// File doesn't exist, serve index.html for SPA routing
			http.ServeFile(w, r, filepath.Join(frontendPath, "index.html"))
			return
		}

		http.ServeFile(w, r, fullPath)
	}
}

// StaticFS is a helper interface for embedding static files (optional).
type StaticFS interface {
	fs.FS
}

// HandleCreate creates a new aggregate instance.
func HandleCreate(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		id, err := app.Create(ctx)
		if err != nil {
			api.Error(w, http.StatusInternalServerError, "CREATE_FAILED", err.Error())
			return
		}

		// Load the new aggregate to get initial state
		agg, err := app.Load(ctx, id)
		if err != nil {
			api.Error(w, http.StatusInternalServerError, "LOAD_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusCreated, api.StateResponse{
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.State(),
			Places:             agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}

// HandleGetState returns the current state of an aggregate.
func HandleGetState(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()
		id := r.PathValue("id")
		if id == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate ID is required")
			return
		}

		agg, err := app.GetState(ctx, id)
		if err != nil {
			api.Error(w, http.StatusNotFound, "NOT_FOUND", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.StateResponse{
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.State(),
			Places:             agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}

// HandleReady checks if the application is ready to serve requests.
// Returns 200 if all dependencies are available, 503 otherwise.
func HandleReady(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		checks := make(map[string]string)
		ready := true

		// Check event store connectivity
		if err := app.HealthCheck(r.Context()); err != nil {
			checks["eventstore"] = err.Error()
			ready = false
		} else {
			checks["eventstore"] = "ok"
		}

		status := http.StatusOK
		statusText := "ready"
		if !ready {
			status = http.StatusServiceUnavailable
			statusText = "not ready"
		}

		api.JSON(w, status, map[string]any{
			"status": statusText,
			"checks": checks,
		})
	}
}


// HandleStartHand handles the start_hand transition.
func HandleStartHand(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionStartHand, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleDealPreflop handles the deal_preflop transition.
func HandleDealPreflop(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionDealPreflop, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleDealFlop handles the deal_flop transition.
func HandleDealFlop(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionDealFlop, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleDealTurn handles the deal_turn transition.
func HandleDealTurn(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionDealTurn, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleDealRiver handles the deal_river transition.
func HandleDealRiver(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionDealRiver, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleGoShowdown handles the go_showdown transition.
func HandleGoShowdown(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionGoShowdown, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleDetermineWinner handles the determine_winner transition.
func HandleDetermineWinner(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionDetermineWinner, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleEndHand handles the end_hand transition.
func HandleEndHand(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionEndHand, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleAdvanceToP1 handles the advance_to_p1 transition.
func HandleAdvanceToP1(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionAdvanceToP1, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleAdvanceToP2 handles the advance_to_p2 transition.
func HandleAdvanceToP2(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionAdvanceToP2, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleAdvanceToP3 handles the advance_to_p3 transition.
func HandleAdvanceToP3(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionAdvanceToP3, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleAdvanceToP4 handles the advance_to_p4 transition.
func HandleAdvanceToP4(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionAdvanceToP4, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleAdvanceToP0 handles the advance_to_p0 transition.
func HandleAdvanceToP0(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionAdvanceToP0, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleEndBettingRound handles the end_betting_round transition.
func HandleEndBettingRound(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionEndBettingRound, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP0Fold handles the p0_fold transition.
func HandleP0Fold(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP0Fold, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP0Check handles the p0_check transition.
func HandleP0Check(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP0Check, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP0Call handles the p0_call transition.
func HandleP0Call(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP0Call, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP0Raise handles the p0_raise transition.
func HandleP0Raise(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP0Raise, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP1Fold handles the p1_fold transition.
func HandleP1Fold(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP1Fold, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP1Check handles the p1_check transition.
func HandleP1Check(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP1Check, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP1Call handles the p1_call transition.
func HandleP1Call(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP1Call, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP1Raise handles the p1_raise transition.
func HandleP1Raise(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP1Raise, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP2Fold handles the p2_fold transition.
func HandleP2Fold(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP2Fold, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP2Check handles the p2_check transition.
func HandleP2Check(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP2Check, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP2Call handles the p2_call transition.
func HandleP2Call(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP2Call, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP2Raise handles the p2_raise transition.
func HandleP2Raise(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP2Raise, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP3Fold handles the p3_fold transition.
func HandleP3Fold(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP3Fold, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP3Check handles the p3_check transition.
func HandleP3Check(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP3Check, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP3Call handles the p3_call transition.
func HandleP3Call(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP3Call, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP3Raise handles the p3_raise transition.
func HandleP3Raise(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP3Raise, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP4Fold handles the p4_fold transition.
func HandleP4Fold(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP4Fold, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP4Check handles the p4_check transition.
func HandleP4Check(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP4Check, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP4Call handles the p4_call transition.
func HandleP4Call(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP4Call, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}


// HandleP4Raise handles the p4_raise transition.
func HandleP4Raise(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()

		var req api.TransitionRequest
		if err := api.DecodeJSON(r, &req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", err.Error())
			return
		}

		if req.AggregateID == "" {
			api.Error(w, http.StatusBadRequest, "MISSING_ID", "aggregate_id is required")
			return
		}

		agg, err := app.Execute(ctx, req.AggregateID, TransitionP4Raise, req.Data)
		if err != nil {
			api.Error(w, http.StatusConflict, "TRANSITION_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, api.TransitionResult{
			Success:            true,
			AggregateID:        agg.ID(),
			Version:            agg.Version(),
			State:              agg.Places(),
			EnabledTransitions: agg.EnabledTransitions(),
		})
	}
}








// HandleGetEvents returns the event history for an aggregate.
func HandleGetEvents(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()
		id := r.PathValue("id")
		from := getIntQueryParam(r, "from", 0)

		events, err := app.store.Read(ctx, id, from)
		if err != nil {
			api.Error(w, http.StatusInternalServerError, "READ_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, map[string]interface{}{
			"events": events,
		})
	}
}

// HandleGetStateAtVersion returns the aggregate state at a specific version.
func HandleGetStateAtVersion(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()
		id := r.PathValue("id")
		versionStr := r.PathValue("version")

		version := getInt(versionStr, 0)
		if version <= 0 {
			api.Error(w, http.StatusBadRequest, "INVALID_VERSION", "version must be a positive integer")
			return
		}

		events, err := app.store.Read(ctx, id, 0)
		if err != nil {
			api.Error(w, http.StatusInternalServerError, "READ_FAILED", err.Error())
			return
		}

		// Create temporary aggregate and replay up to version
		agg := NewAggregate(id)
		for _, evt := range events {
			if evt.Version > version {
				break
			}
			if err := agg.Apply(evt); err != nil {
				api.Error(w, http.StatusInternalServerError, "APPLY_FAILED", err.Error())
				return
			}
		}

		api.JSON(w, http.StatusOK, map[string]interface{}{
			"id":      agg.ID(),
			"version": version,
			"state":   agg.State(),
		})
	}
}

// HandleTruncate truncates the event stream to a specific version.
// This enables "undo and redo differently" workflows by discarding events after the target version.
func HandleTruncate(app *Application) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		ctx := r.Context()
		id := r.PathValue("id")

		var req struct {
			Version int `json:"version"`
		}
		if err := json.NewDecoder(r.Body).Decode(&req); err != nil {
			api.Error(w, http.StatusBadRequest, "INVALID_REQUEST", "request body must contain version field")
			return
		}

		if req.Version < 0 {
			api.Error(w, http.StatusBadRequest, "INVALID_VERSION", "version must be non-negative")
			return
		}

		agg, err := app.TruncateTo(ctx, id, req.Version)
		if err != nil {
			api.Error(w, http.StatusInternalServerError, "TRUNCATE_FAILED", err.Error())
			return
		}

		api.JSON(w, http.StatusOK, map[string]interface{}{
			"id":                    agg.ID(),
			"version":               agg.Version(),
			"state":                 agg.State(),
			"enabled_transitions":   agg.EnabledTransitions(),
		})
	}
}





// Helper functions

func getIntQueryParam(r *http.Request, name string, defaultVal int) int {
	val := r.URL.Query().Get(name)
	return getInt(val, defaultVal)
}

func getInt(s string, defaultVal int) int {
	if s == "" {
		return defaultVal
	}

	intVal, err := strconv.Atoi(s)
	if err != nil {
		return defaultVal
	}

	return intVal
}


// HandleGetSchema returns the model schema JSON for the schema viewer.
func HandleGetSchema() http.HandlerFunc {
	// Schema JSON is embedded at generation time (base64 encoded)
	schemaBase64 := "ewogICJuYW1lIjogInRleGFzLWhvbGRlbSIsCiAgImRlc2NyaXB0aW9uIjogIlRleGFzIEhvbGQnZW0gUG9rZXIgKDUtcGxheWVyIHRhYmxlKSIsCiAgInBsYWNlcyI6IFsKICAgIHsKICAgICAgImlkIjogIndhaXRpbmciLAogICAgICAiZGVzY3JpcHRpb24iOiAiV2FpdGluZyBmb3IgaGFuZCB0byBzdGFydCIsCiAgICAgICJpbml0aWFsIjogMSwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicHJlZmxvcCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQcmUtZmxvcCBiZXR0aW5nIHJvdW5kIiwKICAgICAgImluaXRpYWwiOiAwLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJmbG9wIiwKICAgICAgImRlc2NyaXB0aW9uIjogIkZsb3AgYmV0dGluZyByb3VuZCIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAidHVybl9yb3VuZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJUdXJuIGJldHRpbmcgcm91bmQiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInJpdmVyIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlJpdmVyIGJldHRpbmcgcm91bmQiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInNob3dkb3duIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlNob3dkb3duIC0gY29tcGFyZSBoYW5kcyIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAiY29tcGxldGUiLAogICAgICAiZGVzY3JpcHRpb24iOiAiSGFuZCBjb21wbGV0ZSIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAiZGVhbGVyX2FjdGlvbiIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWFsZXIgY2FuIGRlYWwgY2FyZHMiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAwX3R1cm4iLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDAncyB0dXJuIHRvIGFjdCIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDFfdHVybiIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMSdzIHR1cm4gdG8gYWN0IiwKICAgICAgImluaXRpYWwiOiAwLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMl90dXJuIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAyJ3MgdHVybiB0byBhY3QiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAzX3R1cm4iLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDMncyB0dXJuIHRvIGFjdCIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDRfdHVybiIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgNCdzIHR1cm4gdG8gYWN0IiwKICAgICAgImluaXRpYWwiOiAwLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMF9hY3RpdmUiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDAgaXMgaW4gdGhlIGhhbmQiLAogICAgICAiaW5pdGlhbCI6IDEsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAxX2FjdGl2ZSIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMSBpcyBpbiB0aGUgaGFuZCIsCiAgICAgICJpbml0aWFsIjogMSwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDJfYWN0aXZlIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAyIGlzIGluIHRoZSBoYW5kIiwKICAgICAgImluaXRpYWwiOiAxLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwM19hY3RpdmUiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDMgaXMgaW4gdGhlIGhhbmQiLAogICAgICAiaW5pdGlhbCI6IDEsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInA0X2FjdGl2ZSIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgNCBpcyBpbiB0aGUgaGFuZCIsCiAgICAgICJpbml0aWFsIjogMSwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDBfZm9sZGVkIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAwIGhhcyBmb2xkZWQiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAxX2ZvbGRlZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMSBoYXMgZm9sZGVkIiwKICAgICAgImluaXRpYWwiOiAwLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMl9mb2xkZWQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDIgaGFzIGZvbGRlZCIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDNfZm9sZGVkIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAzIGhhcyBmb2xkZWQiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInA0X2ZvbGRlZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgNCBoYXMgZm9sZGVkIiwKICAgICAgImluaXRpYWwiOiAwLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMF9hY3RlZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMCBoYXMgYWN0ZWQgdGhpcyByb3VuZCIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDFfYWN0ZWQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDEgaGFzIGFjdGVkIHRoaXMgcm91bmQiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAyX2FjdGVkIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAyIGhhcyBhY3RlZCB0aGlzIHJvdW5kIiwKICAgICAgImluaXRpYWwiOiAwLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwM19hY3RlZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMyBoYXMgYWN0ZWQgdGhpcyByb3VuZCIsCiAgICAgICJpbml0aWFsIjogMCwKICAgICAgImtpbmQiOiAidG9rZW4iCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDRfYWN0ZWQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDQgaGFzIGFjdGVkIHRoaXMgcm91bmQiLAogICAgICAiaW5pdGlhbCI6IDAsCiAgICAgICJraW5kIjogInRva2VuIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInJvdW5kX29wZW4iLAogICAgICAiZGVzY3JpcHRpb24iOiAiQmV0dGluZyByb3VuZCBpcyBvcGVuIiwKICAgICAgImluaXRpYWwiOiAwLAogICAgICAia2luZCI6ICJ0b2tlbiIKICAgIH0KICBdLAogICJ0cmFuc2l0aW9ucyI6IFsKICAgIHsKICAgICAgImlkIjogInN0YXJ0X2hhbmQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiU3RhcnQgYSBuZXcgaGFuZCIsCiAgICAgICJldmVudCI6ICJoYW5kX3N0YXJ0ZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9zdGFydF9oYW5kIiwKICAgICAgImV2ZW50X3R5cGUiOiAiaGFuZF9zdGFydGVkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogImRlYWxfcHJlZmxvcCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWFsIGhvbGUgY2FyZHMgdG8gYWxsIHBsYXllcnMiLAogICAgICAiZXZlbnQiOiAicHJlZmxvcF9kZWFsdCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL2RlYWxfcHJlZmxvcCIsCiAgICAgICJldmVudF90eXBlIjogInByZWZsb3BfZGVhbHQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAiZGVhbF9mbG9wIiwKICAgICAgImRlc2NyaXB0aW9uIjogIkRlYWwgdGhlIGZsb3AgKDMgY29tbXVuaXR5IGNhcmRzKSIsCiAgICAgICJldmVudCI6ICJmbG9wX2RlYWx0IiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvZGVhbF9mbG9wIiwKICAgICAgImV2ZW50X3R5cGUiOiAiZmxvcF9kZWFsdCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJkZWFsX3R1cm4iLAogICAgICAiZGVzY3JpcHRpb24iOiAiRGVhbCB0aGUgdHVybiAoMSBjb21tdW5pdHkgY2FyZCkiLAogICAgICAiZXZlbnQiOiAidHVybl9kZWFsdCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL2RlYWxfdHVybiIsCiAgICAgICJldmVudF90eXBlIjogInR1cm5fZGVhbHQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAiZGVhbF9yaXZlciIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWFsIHRoZSByaXZlciAoMSBjb21tdW5pdHkgY2FyZCkiLAogICAgICAiZXZlbnQiOiAicml2ZXJfZGVhbHQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9kZWFsX3JpdmVyIiwKICAgICAgImV2ZW50X3R5cGUiOiAicml2ZXJfZGVhbHQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAiZ29fc2hvd2Rvd24iLAogICAgICAiZGVzY3JpcHRpb24iOiAiUHJvY2VlZCB0byBzaG93ZG93biIsCiAgICAgICJldmVudCI6ICJzaG93ZG93bl9yZWFjaGVkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvZ29fc2hvd2Rvd24iLAogICAgICAiZXZlbnRfdHlwZSI6ICJzaG93ZG93bl9yZWFjaGVkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogImRldGVybWluZV93aW5uZXIiLAogICAgICAiZGVzY3JpcHRpb24iOiAiRGV0ZXJtaW5lIHRoZSB3aW5uZXIiLAogICAgICAiZXZlbnQiOiAid2lubmVyX2RldGVybWluZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9kZXRlcm1pbmVfd2lubmVyIiwKICAgICAgImV2ZW50X3R5cGUiOiAid2lubmVyX2RldGVybWluZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAiZW5kX2hhbmQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiRW5kIHRoZSBoYW5kIiwKICAgICAgImV2ZW50IjogImhhbmRfZW5kZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9lbmRfaGFuZCIsCiAgICAgICJldmVudF90eXBlIjogImhhbmRfZW5kZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAiYWR2YW5jZV90b19wMSIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQYXNzIHR1cm4gdG8gcGxheWVyIDEiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9hZHZhbmNlX3RvX3AxIiwKICAgICAgImV2ZW50X3R5cGUiOiAiQWR2YW5jZVRvUDFlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJhZHZhbmNlX3RvX3AyIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBhc3MgdHVybiB0byBwbGF5ZXIgMiIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL2FkdmFuY2VfdG9fcDIiLAogICAgICAiZXZlbnRfdHlwZSI6ICJBZHZhbmNlVG9QMmVkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogImFkdmFuY2VfdG9fcDMiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGFzcyB0dXJuIHRvIHBsYXllciAzIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvYWR2YW5jZV90b19wMyIsCiAgICAgICJldmVudF90eXBlIjogIkFkdmFuY2VUb1AzZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAiYWR2YW5jZV90b19wNCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQYXNzIHR1cm4gdG8gcGxheWVyIDQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9hZHZhbmNlX3RvX3A0IiwKICAgICAgImV2ZW50X3R5cGUiOiAiQWR2YW5jZVRvUDRlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJhZHZhbmNlX3RvX3AwIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBhc3MgdHVybiB0byBwbGF5ZXIgMCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL2FkdmFuY2VfdG9fcDAiLAogICAgICAiZXZlbnRfdHlwZSI6ICJBZHZhbmNlVG9QMGVkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogImVuZF9iZXR0aW5nX3JvdW5kIiwKICAgICAgImRlc2NyaXB0aW9uIjogIkVuZCB0aGUgYmV0dGluZyByb3VuZCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL2VuZF9iZXR0aW5nX3JvdW5kIiwKICAgICAgImV2ZW50X3R5cGUiOiAiRW5kQmV0dGluZ1JvdW5kZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDBfZm9sZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMCBmb2xkcyIsCiAgICAgICJldmVudCI6ICJwbGF5ZXJfZm9sZGVkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvcDBfZm9sZCIsCiAgICAgICJldmVudF90eXBlIjogInBsYXllcl9mb2xkZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDBfY2hlY2siLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDAgY2hlY2tzIiwKICAgICAgImV2ZW50IjogInBsYXllcl9jaGVja2VkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvcDBfY2hlY2siLAogICAgICAiZXZlbnRfdHlwZSI6ICJwbGF5ZXJfY2hlY2tlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMF9jYWxsIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAwIGNhbGxzIiwKICAgICAgImV2ZW50IjogInBsYXllcl9jYWxsZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9wMF9jYWxsIiwKICAgICAgImV2ZW50X3R5cGUiOiAicGxheWVyX2NhbGxlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMF9yYWlzZSIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMCByYWlzZXMiLAogICAgICAiZXZlbnQiOiAicGxheWVyX3JhaXNlZCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL3AwX3JhaXNlIiwKICAgICAgImV2ZW50X3R5cGUiOiAicGxheWVyX3JhaXNlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMV9mb2xkIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAxIGZvbGRzIiwKICAgICAgImV2ZW50IjogInBsYXllcl9mb2xkZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9wMV9mb2xkIiwKICAgICAgImV2ZW50X3R5cGUiOiAicGxheWVyX2ZvbGRlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwMV9jaGVjayIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMSBjaGVja3MiLAogICAgICAiZXZlbnQiOiAicGxheWVyX2NoZWNrZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9wMV9jaGVjayIsCiAgICAgICJldmVudF90eXBlIjogInBsYXllcl9jaGVja2VkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAxX2NhbGwiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDEgY2FsbHMiLAogICAgICAiZXZlbnQiOiAicGxheWVyX2NhbGxlZCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL3AxX2NhbGwiLAogICAgICAiZXZlbnRfdHlwZSI6ICJwbGF5ZXJfY2FsbGVkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAxX3JhaXNlIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAxIHJhaXNlcyIsCiAgICAgICJldmVudCI6ICJwbGF5ZXJfcmFpc2VkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvcDFfcmFpc2UiLAogICAgICAiZXZlbnRfdHlwZSI6ICJwbGF5ZXJfcmFpc2VkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAyX2ZvbGQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDIgZm9sZHMiLAogICAgICAiZXZlbnQiOiAicGxheWVyX2ZvbGRlZCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL3AyX2ZvbGQiLAogICAgICAiZXZlbnRfdHlwZSI6ICJwbGF5ZXJfZm9sZGVkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInAyX2NoZWNrIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAyIGNoZWNrcyIsCiAgICAgICJldmVudCI6ICJwbGF5ZXJfY2hlY2tlZCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL3AyX2NoZWNrIiwKICAgICAgImV2ZW50X3R5cGUiOiAicGxheWVyX2NoZWNrZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDJfY2FsbCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMiBjYWxscyIsCiAgICAgICJldmVudCI6ICJwbGF5ZXJfY2FsbGVkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvcDJfY2FsbCIsCiAgICAgICJldmVudF90eXBlIjogInBsYXllcl9jYWxsZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDJfcmFpc2UiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDIgcmFpc2VzIiwKICAgICAgImV2ZW50IjogInBsYXllcl9yYWlzZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9wMl9yYWlzZSIsCiAgICAgICJldmVudF90eXBlIjogInBsYXllcl9yYWlzZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDNfZm9sZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMyBmb2xkcyIsCiAgICAgICJldmVudCI6ICJwbGF5ZXJfZm9sZGVkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvcDNfZm9sZCIsCiAgICAgICJldmVudF90eXBlIjogInBsYXllcl9mb2xkZWQiCiAgICB9LAogICAgewogICAgICAiaWQiOiAicDNfY2hlY2siLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDMgY2hlY2tzIiwKICAgICAgImV2ZW50IjogInBsYXllcl9jaGVja2VkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvcDNfY2hlY2siLAogICAgICAiZXZlbnRfdHlwZSI6ICJwbGF5ZXJfY2hlY2tlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwM19jYWxsIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciAzIGNhbGxzIiwKICAgICAgImV2ZW50IjogInBsYXllcl9jYWxsZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9wM19jYWxsIiwKICAgICAgImV2ZW50X3R5cGUiOiAicGxheWVyX2NhbGxlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwM19yYWlzZSIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgMyByYWlzZXMiLAogICAgICAiZXZlbnQiOiAicGxheWVyX3JhaXNlZCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL3AzX3JhaXNlIiwKICAgICAgImV2ZW50X3R5cGUiOiAicGxheWVyX3JhaXNlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwNF9mb2xkIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciA0IGZvbGRzIiwKICAgICAgImV2ZW50IjogInBsYXllcl9mb2xkZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9wNF9mb2xkIiwKICAgICAgImV2ZW50X3R5cGUiOiAicGxheWVyX2ZvbGRlZCIKICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwNF9jaGVjayIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5ZXIgNCBjaGVja3MiLAogICAgICAiZXZlbnQiOiAicGxheWVyX2NoZWNrZWQiLAogICAgICAiaHR0cF9tZXRob2QiOiAiUE9TVCIsCiAgICAgICJodHRwX3BhdGgiOiAiL2FwaS9wNF9jaGVjayIsCiAgICAgICJldmVudF90eXBlIjogInBsYXllcl9jaGVja2VkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInA0X2NhbGwiLAogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheWVyIDQgY2FsbHMiLAogICAgICAiZXZlbnQiOiAicGxheWVyX2NhbGxlZCIsCiAgICAgICJodHRwX21ldGhvZCI6ICJQT1NUIiwKICAgICAgImh0dHBfcGF0aCI6ICIvYXBpL3A0X2NhbGwiLAogICAgICAiZXZlbnRfdHlwZSI6ICJwbGF5ZXJfY2FsbGVkIgogICAgfSwKICAgIHsKICAgICAgImlkIjogInA0X3JhaXNlIiwKICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXllciA0IHJhaXNlcyIsCiAgICAgICJldmVudCI6ICJwbGF5ZXJfcmFpc2VkIiwKICAgICAgImh0dHBfbWV0aG9kIjogIlBPU1QiLAogICAgICAiaHR0cF9wYXRoIjogIi9hcGkvcDRfcmFpc2UiLAogICAgICAiZXZlbnRfdHlwZSI6ICJwbGF5ZXJfcmFpc2VkIgogICAgfQogIF0sCiAgImFyY3MiOiBbCiAgICB7CiAgICAgICJmcm9tIjogIndhaXRpbmciLAogICAgICAidG8iOiAic3RhcnRfaGFuZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInN0YXJ0X2hhbmQiLAogICAgICAidG8iOiAiZGVhbGVyX2FjdGlvbiIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImRlYWxlcl9hY3Rpb24iLAogICAgICAidG8iOiAiZGVhbF9wcmVmbG9wIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZGVhbF9wcmVmbG9wIiwKICAgICAgInRvIjogInByZWZsb3AiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJkZWFsX3ByZWZsb3AiLAogICAgICAidG8iOiAicDBfdHVybiIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImRlYWxfcHJlZmxvcCIsCiAgICAgICJ0byI6ICJyb3VuZF9vcGVuIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDBfdHVybiIsCiAgICAgICJ0byI6ICJwMF9mb2xkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDBfYWN0aXZlIiwKICAgICAgInRvIjogInAwX2ZvbGQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF9mb2xkIiwKICAgICAgInRvIjogInAwX2ZvbGRlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAwX2ZvbGQiLAogICAgICAidG8iOiAicDBfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF90dXJuIiwKICAgICAgInRvIjogInAwX2NoZWNrIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDBfYWN0aXZlIiwKICAgICAgInRvIjogInAwX2NoZWNrIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDBfY2hlY2siLAogICAgICAidG8iOiAicDBfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDBfY2hlY2siLAogICAgICAidG8iOiAicDBfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF90dXJuIiwKICAgICAgInRvIjogInAwX2NhbGwiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF9hY3RpdmUiLAogICAgICAidG8iOiAicDBfY2FsbCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAwX2NhbGwiLAogICAgICAidG8iOiAicDBfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDBfY2FsbCIsCiAgICAgICJ0byI6ICJwMF9hY3RlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAwX3R1cm4iLAogICAgICAidG8iOiAicDBfcmFpc2UiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF9hY3RpdmUiLAogICAgICAidG8iOiAicDBfcmFpc2UiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF9yYWlzZSIsCiAgICAgICJ0byI6ICJwMF9hY3RpdmUiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF9yYWlzZSIsCiAgICAgICJ0byI6ICJwMF9hY3RlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAxX3R1cm4iLAogICAgICAidG8iOiAicDFfZm9sZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAxX2FjdGl2ZSIsCiAgICAgICJ0byI6ICJwMV9mb2xkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfZm9sZCIsCiAgICAgICJ0byI6ICJwMV9mb2xkZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMV9mb2xkIiwKICAgICAgInRvIjogInAxX2FjdGVkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfdHVybiIsCiAgICAgICJ0byI6ICJwMV9jaGVjayIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAxX2FjdGl2ZSIsCiAgICAgICJ0byI6ICJwMV9jaGVjayIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAxX2NoZWNrIiwKICAgICAgInRvIjogInAxX2FjdGl2ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAxX2NoZWNrIiwKICAgICAgInRvIjogInAxX2FjdGVkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfdHVybiIsCiAgICAgICJ0byI6ICJwMV9jYWxsIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfYWN0aXZlIiwKICAgICAgInRvIjogInAxX2NhbGwiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMV9jYWxsIiwKICAgICAgInRvIjogInAxX2FjdGl2ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAxX2NhbGwiLAogICAgICAidG8iOiAicDFfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMV90dXJuIiwKICAgICAgInRvIjogInAxX3JhaXNlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfYWN0aXZlIiwKICAgICAgInRvIjogInAxX3JhaXNlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfcmFpc2UiLAogICAgICAidG8iOiAicDFfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfcmFpc2UiLAogICAgICAidG8iOiAicDFfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl90dXJuIiwKICAgICAgInRvIjogInAyX2ZvbGQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl9hY3RpdmUiLAogICAgICAidG8iOiAicDJfZm9sZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAyX2ZvbGQiLAogICAgICAidG8iOiAicDJfZm9sZGVkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDJfZm9sZCIsCiAgICAgICJ0byI6ICJwMl9hY3RlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAyX3R1cm4iLAogICAgICAidG8iOiAicDJfY2hlY2siCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl9hY3RpdmUiLAogICAgICAidG8iOiAicDJfY2hlY2siCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl9jaGVjayIsCiAgICAgICJ0byI6ICJwMl9hY3RpdmUiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl9jaGVjayIsCiAgICAgICJ0byI6ICJwMl9hY3RlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAyX3R1cm4iLAogICAgICAidG8iOiAicDJfY2FsbCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAyX2FjdGl2ZSIsCiAgICAgICJ0byI6ICJwMl9jYWxsIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDJfY2FsbCIsCiAgICAgICJ0byI6ICJwMl9hY3RpdmUiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl9jYWxsIiwKICAgICAgInRvIjogInAyX2FjdGVkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDJfdHVybiIsCiAgICAgICJ0byI6ICJwMl9yYWlzZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAyX2FjdGl2ZSIsCiAgICAgICJ0byI6ICJwMl9yYWlzZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAyX3JhaXNlIiwKICAgICAgInRvIjogInAyX2FjdGl2ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAyX3JhaXNlIiwKICAgICAgInRvIjogInAyX2FjdGVkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDNfdHVybiIsCiAgICAgICJ0byI6ICJwM19mb2xkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDNfYWN0aXZlIiwKICAgICAgInRvIjogInAzX2ZvbGQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM19mb2xkIiwKICAgICAgInRvIjogInAzX2ZvbGRlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAzX2ZvbGQiLAogICAgICAidG8iOiAicDNfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM190dXJuIiwKICAgICAgInRvIjogInAzX2NoZWNrIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDNfYWN0aXZlIiwKICAgICAgInRvIjogInAzX2NoZWNrIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDNfY2hlY2siLAogICAgICAidG8iOiAicDNfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDNfY2hlY2siLAogICAgICAidG8iOiAicDNfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM190dXJuIiwKICAgICAgInRvIjogInAzX2NhbGwiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM19hY3RpdmUiLAogICAgICAidG8iOiAicDNfY2FsbCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAzX2NhbGwiLAogICAgICAidG8iOiAicDNfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDNfY2FsbCIsCiAgICAgICJ0byI6ICJwM19hY3RlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAzX3R1cm4iLAogICAgICAidG8iOiAicDNfcmFpc2UiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM19hY3RpdmUiLAogICAgICAidG8iOiAicDNfcmFpc2UiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM19yYWlzZSIsCiAgICAgICJ0byI6ICJwM19hY3RpdmUiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM19yYWlzZSIsCiAgICAgICJ0byI6ICJwM19hY3RlZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInA0X3R1cm4iLAogICAgICAidG8iOiAicDRfZm9sZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInA0X2FjdGl2ZSIsCiAgICAgICJ0byI6ICJwNF9mb2xkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfZm9sZCIsCiAgICAgICJ0byI6ICJwNF9mb2xkZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwNF9mb2xkIiwKICAgICAgInRvIjogInA0X2FjdGVkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfdHVybiIsCiAgICAgICJ0byI6ICJwNF9jaGVjayIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInA0X2FjdGl2ZSIsCiAgICAgICJ0byI6ICJwNF9jaGVjayIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInA0X2NoZWNrIiwKICAgICAgInRvIjogInA0X2FjdGl2ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInA0X2NoZWNrIiwKICAgICAgInRvIjogInA0X2FjdGVkIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfdHVybiIsCiAgICAgICJ0byI6ICJwNF9jYWxsIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfYWN0aXZlIiwKICAgICAgInRvIjogInA0X2NhbGwiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwNF9jYWxsIiwKICAgICAgInRvIjogInA0X2FjdGl2ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInA0X2NhbGwiLAogICAgICAidG8iOiAicDRfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwNF90dXJuIiwKICAgICAgInRvIjogInA0X3JhaXNlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfYWN0aXZlIiwKICAgICAgInRvIjogInA0X3JhaXNlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfcmFpc2UiLAogICAgICAidG8iOiAicDRfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfcmFpc2UiLAogICAgICAidG8iOiAicDRfYWN0ZWQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF9hY3RlZCIsCiAgICAgICJ0byI6ICJhZHZhbmNlX3RvX3AxIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfYWN0aXZlIiwKICAgICAgInRvIjogImFkdmFuY2VfdG9fcDEiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJhZHZhbmNlX3RvX3AxIiwKICAgICAgInRvIjogInAxX3R1cm4iCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJhZHZhbmNlX3RvX3AxIiwKICAgICAgInRvIjogInAxX2FjdGl2ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAxX2FjdGVkIiwKICAgICAgInRvIjogImFkdmFuY2VfdG9fcDIiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl9hY3RpdmUiLAogICAgICAidG8iOiAiYWR2YW5jZV90b19wMiIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImFkdmFuY2VfdG9fcDIiLAogICAgICAidG8iOiAicDJfdHVybiIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImFkdmFuY2VfdG9fcDIiLAogICAgICAidG8iOiAicDJfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDJfYWN0ZWQiLAogICAgICAidG8iOiAiYWR2YW5jZV90b19wMyIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAzX2FjdGl2ZSIsCiAgICAgICJ0byI6ICJhZHZhbmNlX3RvX3AzIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiYWR2YW5jZV90b19wMyIsCiAgICAgICJ0byI6ICJwM190dXJuIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiYWR2YW5jZV90b19wMyIsCiAgICAgICJ0byI6ICJwM19hY3RpdmUiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwM19hY3RlZCIsCiAgICAgICJ0byI6ICJhZHZhbmNlX3RvX3A0IgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfYWN0aXZlIiwKICAgICAgInRvIjogImFkdmFuY2VfdG9fcDQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJhZHZhbmNlX3RvX3A0IiwKICAgICAgInRvIjogInA0X3R1cm4iCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJhZHZhbmNlX3RvX3A0IiwKICAgICAgInRvIjogInA0X2FjdGl2ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInA0X2FjdGVkIiwKICAgICAgInRvIjogImFkdmFuY2VfdG9fcDAiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMF9hY3RpdmUiLAogICAgICAidG8iOiAiYWR2YW5jZV90b19wMCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImFkdmFuY2VfdG9fcDAiLAogICAgICAidG8iOiAicDBfdHVybiIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImFkdmFuY2VfdG9fcDAiLAogICAgICAidG8iOiAicDBfYWN0aXZlIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicm91bmRfb3BlbiIsCiAgICAgICJ0byI6ICJlbmRfYmV0dGluZ19yb3VuZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAwX2FjdGVkIiwKICAgICAgInRvIjogImVuZF9iZXR0aW5nX3JvdW5kIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDFfYWN0ZWQiLAogICAgICAidG8iOiAiZW5kX2JldHRpbmdfcm91bmQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJwMl9hY3RlZCIsCiAgICAgICJ0byI6ICJlbmRfYmV0dGluZ19yb3VuZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogInAzX2FjdGVkIiwKICAgICAgInRvIjogImVuZF9iZXR0aW5nX3JvdW5kIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicDRfYWN0ZWQiLAogICAgICAidG8iOiAiZW5kX2JldHRpbmdfcm91bmQiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJlbmRfYmV0dGluZ19yb3VuZCIsCiAgICAgICJ0byI6ICJkZWFsZXJfYWN0aW9uIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicHJlZmxvcCIsCiAgICAgICJ0byI6ICJkZWFsX2Zsb3AiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJkZWFsZXJfYWN0aW9uIiwKICAgICAgInRvIjogImRlYWxfZmxvcCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImRlYWxfZmxvcCIsCiAgICAgICJ0byI6ICJmbG9wIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZGVhbF9mbG9wIiwKICAgICAgInRvIjogInAwX3R1cm4iCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJkZWFsX2Zsb3AiLAogICAgICAidG8iOiAicm91bmRfb3BlbiIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImZsb3AiLAogICAgICAidG8iOiAiZGVhbF90dXJuIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZGVhbGVyX2FjdGlvbiIsCiAgICAgICJ0byI6ICJkZWFsX3R1cm4iCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJkZWFsX3R1cm4iLAogICAgICAidG8iOiAidHVybl9yb3VuZCIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImRlYWxfdHVybiIsCiAgICAgICJ0byI6ICJwMF90dXJuIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZGVhbF90dXJuIiwKICAgICAgInRvIjogInJvdW5kX29wZW4iCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJ0dXJuX3JvdW5kIiwKICAgICAgInRvIjogImRlYWxfcml2ZXIiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJkZWFsZXJfYWN0aW9uIiwKICAgICAgInRvIjogImRlYWxfcml2ZXIiCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJkZWFsX3JpdmVyIiwKICAgICAgInRvIjogInJpdmVyIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZGVhbF9yaXZlciIsCiAgICAgICJ0byI6ICJwMF90dXJuIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZGVhbF9yaXZlciIsCiAgICAgICJ0byI6ICJyb3VuZF9vcGVuIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAicml2ZXIiLAogICAgICAidG8iOiAiZ29fc2hvd2Rvd24iCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJkZWFsZXJfYWN0aW9uIiwKICAgICAgInRvIjogImdvX3Nob3dkb3duIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZ29fc2hvd2Rvd24iLAogICAgICAidG8iOiAic2hvd2Rvd24iCiAgICB9LAogICAgewogICAgICAiZnJvbSI6ICJzaG93ZG93biIsCiAgICAgICJ0byI6ICJkZXRlcm1pbmVfd2lubmVyIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZGV0ZXJtaW5lX3dpbm5lciIsCiAgICAgICJ0byI6ICJjb21wbGV0ZSIKICAgIH0sCiAgICB7CiAgICAgICJmcm9tIjogImNvbXBsZXRlIiwKICAgICAgInRvIjogImVuZF9oYW5kIgogICAgfSwKICAgIHsKICAgICAgImZyb20iOiAiZW5kX2hhbmQiLAogICAgICAidG8iOiAid2FpdGluZyIKICAgIH0KICBdLAogICJldmVudHMiOiBbCiAgICB7CiAgICAgICJpZCI6ICJoYW5kX3N0YXJ0ZWQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiQSBuZXcgaGFuZCBoYXMgc3RhcnRlZCIsCiAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAiaGFuZF9udW1iZXIiLAogICAgICAgICAgInR5cGUiOiAiaW50NjQiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJkZWFsZXJfcG9zaXRpb24iLAogICAgICAgICAgInR5cGUiOiAiaW50NjQiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJzbWFsbF9ibGluZCIsCiAgICAgICAgICAidHlwZSI6ICJpbnQ2NCIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICJuYW1lIjogImJpZ19ibGluZCIsCiAgICAgICAgICAidHlwZSI6ICJpbnQ2NCIKICAgICAgICB9CiAgICAgIF0KICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwcmVmbG9wX2RlYWx0IiwKICAgICAgImRlc2NyaXB0aW9uIjogIkhvbGUgY2FyZHMgZGVhbHQgdG8gcGxheWVycyIsCiAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAiaGFuZHMiLAogICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJKU09OIGVuY29kZWQgaG9sZSBjYXJkcyBwZXIgcGxheWVyIgogICAgICAgIH0KICAgICAgXQogICAgfSwKICAgIHsKICAgICAgImlkIjogImZsb3BfZGVhbHQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiRmxvcCBjYXJkcyBkZWFsdCIsCiAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAiY2FyZHMiLAogICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJKU09OIGFycmF5IG9mIDMgY2FyZHMiCiAgICAgICAgfQogICAgICBdCiAgICB9LAogICAgewogICAgICAiaWQiOiAidHVybl9kZWFsdCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJUdXJuIGNhcmQgZGVhbHQiLAogICAgICAiZmllbGRzIjogWwogICAgICAgIHsKICAgICAgICAgICJuYW1lIjogImNhcmQiLAogICAgICAgICAgInR5cGUiOiAic3RyaW5nIgogICAgICAgIH0KICAgICAgXQogICAgfSwKICAgIHsKICAgICAgImlkIjogInJpdmVyX2RlYWx0IiwKICAgICAgImRlc2NyaXB0aW9uIjogIlJpdmVyIGNhcmQgZGVhbHQiLAogICAgICAiZmllbGRzIjogWwogICAgICAgIHsKICAgICAgICAgICJuYW1lIjogImNhcmQiLAogICAgICAgICAgInR5cGUiOiAic3RyaW5nIgogICAgICAgIH0KICAgICAgXQogICAgfSwKICAgIHsKICAgICAgImlkIjogInBsYXllcl9mb2xkZWQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiQSBwbGF5ZXIgZm9sZGVkIiwKICAgICAgImZpZWxkcyI6IFsKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJwbGF5ZXIiLAogICAgICAgICAgInR5cGUiOiAiaW50NjQiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJzZWF0IiwKICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICB9CiAgICAgIF0KICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwbGF5ZXJfY2hlY2tlZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJBIHBsYXllciBjaGVja2VkIiwKICAgICAgImZpZWxkcyI6IFsKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJwbGF5ZXIiLAogICAgICAgICAgInR5cGUiOiAiaW50NjQiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJzZWF0IiwKICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICB9CiAgICAgIF0KICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJwbGF5ZXJfY2FsbGVkIiwKICAgICAgImRlc2NyaXB0aW9uIjogIkEgcGxheWVyIGNhbGxlZCIsCiAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAicGxheWVyIiwKICAgICAgICAgICJ0eXBlIjogImludDY0IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAic2VhdCIsCiAgICAgICAgICAidHlwZSI6ICJzdHJpbmciCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJhbW91bnQiLAogICAgICAgICAgInR5cGUiOiAiaW50NjQiCiAgICAgICAgfQogICAgICBdCiAgICB9LAogICAgewogICAgICAiaWQiOiAicGxheWVyX3JhaXNlZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJBIHBsYXllciByYWlzZWQiLAogICAgICAiZmllbGRzIjogWwogICAgICAgIHsKICAgICAgICAgICJuYW1lIjogInBsYXllciIsCiAgICAgICAgICAidHlwZSI6ICJpbnQ2NCIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICJuYW1lIjogInNlYXQiLAogICAgICAgICAgInR5cGUiOiAic3RyaW5nIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAiYW1vdW50IiwKICAgICAgICAgICJ0eXBlIjogImludDY0IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAidG90YWxfYmV0IiwKICAgICAgICAgICJ0eXBlIjogImludDY0IgogICAgICAgIH0KICAgICAgXQogICAgfSwKICAgIHsKICAgICAgImlkIjogInNob3dkb3duX3JlYWNoZWQiLAogICAgICAiZGVzY3JpcHRpb24iOiAiQWxsIGJldHRpbmcgY29tcGxldGUsIHByb2NlZWRpbmcgdG8gc2hvd2Rvd24iLAogICAgICAiZmllbGRzIjogW10KICAgIH0sCiAgICB7CiAgICAgICJpZCI6ICJ3aW5uZXJfZGV0ZXJtaW5lZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJXaW5uZXIgaGFzIGJlZW4gZGV0ZXJtaW5lZCIsCiAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAid2lubmVyIiwKICAgICAgICAgICJ0eXBlIjogImludDY0IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIm5hbWUiOiAid2lubmluZ19oYW5kIiwKICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICJuYW1lIjogInBvdF9hbW91bnQiLAogICAgICAgICAgInR5cGUiOiAiaW50NjQiCiAgICAgICAgfQogICAgICBdCiAgICB9LAogICAgewogICAgICAiaWQiOiAiaGFuZF9lbmRlZCIsCiAgICAgICJkZXNjcmlwdGlvbiI6ICJIYW5kIGlzIGNvbXBsZXRlIiwKICAgICAgImZpZWxkcyI6IFsKICAgICAgICB7CiAgICAgICAgICAibmFtZSI6ICJoYW5kX251bWJlciIsCiAgICAgICAgICAidHlwZSI6ICJpbnQ2NCIKICAgICAgICB9CiAgICAgIF0KICAgIH0KICBdCn0="

	return func(w http.ResponseWriter, r *http.Request) {
		schemaJSON, err := base64.StdEncoding.DecodeString(schemaBase64)
		if err != nil {
			api.Error(w, http.StatusInternalServerError, "schema_decode_error", "Failed to decode schema")
			return
		}
		w.Header().Set("Content-Type", "application/json")
		w.WriteHeader(http.StatusOK)
		w.Write(schemaJSON)
	}
}

