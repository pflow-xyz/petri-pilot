// tic-tac-toe Extensions
// Generated by petri-pilot as a starting point - CUSTOMIZE THIS FILE
// This file is generated once and won't be overwritten on regeneration

/**
 * Extension Points for tic-tac-toe
 *
 * This file lets you customize the generated application without
 * modifying regenerated code. Add your customizations here and they
 * will be preserved when you regenerate.
 *
 * Available extension points:
 * - adminExtensions: Customize admin dashboard behavior
 * - viewExtensions: Add custom renderers for instance views
 * - hooks: Register callbacks for lifecycle events
 */

// =============================================================================
// ADMIN EXTENSIONS
// =============================================================================

export const adminExtensions = {
  /**
   * Add custom columns to the instance table
   * Return array of { header: string, render: (instance) => string }
   */
  customColumns: [],

  /**
   * Add custom action buttons to instance detail
   * Return array of { label: string, onClick: (instance) => void, className?: string }
   */
  customActions: [],

  /**
   * Custom renderer for instance rows (optional)
   * If defined, replaces the default row rendering
   * @param {Object} instance - The instance data
   * @param {Function} defaultRender - Call this to get default rendering
   * @returns {string} HTML string
   */
  renderInstanceRow: null,

  /**
   * Custom renderer for instance detail (optional)
   * @param {Object} instance - The instance data
   * @param {Function} defaultRender - Call this to get default rendering
   * @returns {string} HTML string
   */
  renderInstanceDetail: null,
}

// =============================================================================
// VIEW EXTENSIONS
// =============================================================================

export const viewExtensions = {
  /**
   * Custom state renderer for specific places
   * Map of place name to render function: (value, place, instance) => string
   */
  stateRenderers: {},

  /**
   * Custom transition button renderer
   * @param {string} transitionId - The transition ID
   * @param {boolean} enabled - Whether the transition is enabled
   * @param {Object} instance - The instance data
   * @returns {string|null} HTML string or null for default
   */
  renderTransitionButton: null,

  /**
   * Add custom sections to instance view
   * Return array of { title: string, render: (instance) => string }
   */
  customSections: [],
}

// =============================================================================
// LIFECYCLE HOOKS
// =============================================================================

export const hooks = {
  /**
   * Called after an instance is created
   * @param {Object} instance - The new instance
   */
  onInstanceCreated: [],

  /**
   * Called after a transition is executed
   * @param {string} transitionId - The transition that fired
   * @param {Object} instance - The updated instance
   */
  onTransitionExecuted: [],

  /**
   * Called after an instance is archived
   * @param {string} instanceId - The archived instance ID
   */
  onInstanceArchived: [],

  /**
   * Called after an instance is restored
   * @param {string} instanceId - The restored instance ID
   */
  onInstanceRestored: [],

  /**
   * Called after an instance is permanently deleted
   * @param {string} instanceId - The deleted instance ID
   */
  onInstanceDeleted: [],
}

/**
 * Register a hook callback
 * @param {string} hookName - Name of the hook (e.g., 'onInstanceCreated')
 * @param {Function} callback - The callback function
 */
export function registerHook(hookName, callback) {
  if (hooks[hookName] && Array.isArray(hooks[hookName])) {
    hooks[hookName].push(callback)
  } else {
    console.warn(`Unknown hook: ${hookName}`)
  }
}

/**
 * Trigger a hook with arguments
 * @param {string} hookName - Name of the hook
 * @param {...any} args - Arguments to pass to callbacks
 */
export function triggerHook(hookName, ...args) {
  if (hooks[hookName] && Array.isArray(hooks[hookName])) {
    hooks[hookName].forEach(callback => {
      try {
        callback(...args)
      } catch (error) {
        console.error(`Error in hook ${hookName}:`, error)
      }
    })
  }
}

// =============================================================================
// EXAMPLE CUSTOMIZATIONS (uncomment to use)
// =============================================================================

/*
// Example: Add a custom "Export JSON" action to admin
adminExtensions.customActions.push({
  label: 'Export JSON',
  className: 'btn btn-secondary',
  onClick: (instance) => {
    const json = JSON.stringify(instance, null, 2)
    const blob = new Blob([json], { type: 'application/json' })
    const url = URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    a.download = `${instance.id}.json`
    a.click()
  }
})

// Example: Custom state renderer for a "balance" place
viewExtensions.stateRenderers['balance'] = (value, place, instance) => {
  return `<span class="currency">$${(value / 100).toFixed(2)}</span>`
}

// Example: Log all transitions
registerHook('onTransitionExecuted', (transitionId, instance) => {
  console.log(`Transition ${transitionId} executed on ${instance.id}`)
})
*/
